
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>API &mdash; XTCP TCP/IP Stack v2v0 documentation</title>
    <link rel="stylesheet" href="_static/xdoc.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '2v0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="http://mathjax.connectmv.com/MathJax.js"></script>
    <link rel="top" title="XTCP TCP/IP Stack v2v0 documentation" href="index.html" />
    <link rel="next" title="References" href="references.html" />
    <link rel="prev" title="An XMOS AVB application (tutorial)" href="app_tutorial.html" /> 

<script>
function setheight() {
h1 = document.getElementById('d1').style.height;
h2 = document.getElementById('d2').style.height;

if (parseInt(h1) > parseInt(h2)) {
document.getElementById('d2').style.height=h1 + "px";
}
else {
document.getElementById('d1').style.height=h2 + "px";
}

}
</script>
</head>

<body onload="setheight();">

  

    <div class="document" id='d1'>
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
<div style="float: right">
<a href="app_tutorial.html"
                        title="previous chapter"> &lt&lt </a>
<a href="references.html"
                        title="next chapter"> &gt&gt </a></p>
</div>

            
  <div class="section" id="api">
<span id="sec-api"></span><h1>API<a class="headerlink" href="#api" title="Permalink to this headline">¶</a></h1>
<div class="section" id="configuration-defines">
<span id="sec-config-defines"></span><h2>Configuration Defines<a class="headerlink" href="#configuration-defines" title="Permalink to this headline">¶</a></h2>
<p>The following defines can be set by adding the file
<tt class="docutils literal"><span class="pre">xtcp_client_conf.h</span></tt> into your application and setting the defines
within that file.</p>
<table border="1" class="docutils">
<colgroup>
<col width="50%" />
<col width="33%" />
<col width="17%" />
</colgroup>
<thead valign="bottom">
<tr><th class="head">Define</th>
<th class="head">Description</th>
<th class="head">Default</th>
</tr>
</thead>
<tbody valign="top">
<tr><td><tt class="docutils literal"><span class="pre">XTCP_CLIENT_BUF_SIZE</span></tt></td>
<td>The buffer size used for incoming packets. This has a maximum
value of 1472 which can handle any incoming packet. If it is
set to less larger incoming packets will be truncated.</td>
<td>1472</td>
</tr>
<tr><td><tt class="docutils literal"><span class="pre">UIP_CONF_MAX_CONNECTIONS</span></tt></td>
<td>The maximum number of UDP or TCP connections the server can
handle simultaneously.</td>
<td>20</td>
</tr>
<tr><td><tt class="docutils literal"><span class="pre">UIP_CONF_MAX_LISTENPORTS</span></tt></td>
<td>The maximum number of UDP or TCP ports the server can listen to
simultaneously.</td>
<td>20</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="data-structures-types">
<h2>Data Structures/Types<a class="headerlink" href="#data-structures-types" title="Permalink to this headline">¶</a></h2>
<dt><dl class="type">
<dt id="xtcp_ipaddr_t">
<tt class="descname">xtcp_ipaddr_t</tt><a class="headerlink" href="#xtcp_ipaddr_t" title="Permalink to this definition">¶</a></dt>
<dd><p>XTCP IP address.</p>
<p>This data type represents a single ipv4 address in the XTCP stack.</p>
</dd></dl>

<dt><dl class="type">
<dt id="xtcp_ipconfig_t">
<tt class="descname">xtcp_ipconfig_t</tt><a class="headerlink" href="#xtcp_ipconfig_t" title="Permalink to this definition">¶</a></dt>
<dd><p>IP configuration information structure.</p>
<p>This structure describes IP configuration for an ip node.</p>
<p><strong>Structure Members</strong>:</p>
<dl class="member">
<dt id="xtcp_ipconfig_t.ipaddr">
<a class="reference internal" href="#xtcp_ipaddr_t" title="xtcp_ipaddr_t">xtcp_ipaddr_t</a> <tt class="descname">ipaddr</tt><a class="headerlink" href="#xtcp_ipconfig_t.ipaddr" title="Permalink to this definition">¶</a></dt>
<dd><p>The IP Address of the node.</p>
</dd></dl>

<dl class="member">
<dt id="xtcp_ipconfig_t.netmask">
<a class="reference internal" href="#xtcp_ipaddr_t" title="xtcp_ipaddr_t">xtcp_ipaddr_t</a> <tt class="descname">netmask</tt><a class="headerlink" href="#xtcp_ipconfig_t.netmask" title="Permalink to this definition">¶</a></dt>
<dd><p>The netmask of the node.</p>
<p>The mask used to determine which address are routed locally.</p>
</dd></dl>

<dl class="member">
<dt id="xtcp_ipconfig_t.gateway">
<a class="reference internal" href="#xtcp_ipaddr_t" title="xtcp_ipaddr_t">xtcp_ipaddr_t</a> <tt class="descname">gateway</tt><a class="headerlink" href="#xtcp_ipconfig_t.gateway" title="Permalink to this definition">¶</a></dt>
<dd><p>The gateway of the node.</p>
</dd></dl>

</dd></dl>

<dt><dl class="type">
<dt id="xtcp_protocol_t">
<tt class="descname">xtcp_protocol_t</tt><a class="headerlink" href="#xtcp_protocol_t" title="Permalink to this definition">¶</a></dt>
<dd><p>XTCP protocol type.</p>
<p>This determines what type a connection is: either UDP or TCP.</p>
<p><strong>Enum Values:</strong></p>
<blockquote>
<div><dl class="member">
<dt id="xtcp_protocol_t.XTCP_PROTOCOL_TCP">
<tt class="descname">XTCP_PROTOCOL_TCP</tt><a class="headerlink" href="#xtcp_protocol_t.XTCP_PROTOCOL_TCP" title="Permalink to this definition">¶</a></dt>
<dd><p>Transmission Control Protocol.</p>
</dd></dl>

<dl class="member">
<dt id="xtcp_protocol_t.XTCP_PROTOCOL_UDP">
<tt class="descname">XTCP_PROTOCOL_UDP</tt><a class="headerlink" href="#xtcp_protocol_t.XTCP_PROTOCOL_UDP" title="Permalink to this definition">¶</a></dt>
<dd><p>User Datagram Protocol.</p>
</dd></dl>

</div></blockquote>
</dd></dl>

<dt><dl class="type">
<dt id="xtcp_event_type_t">
<tt class="descname">xtcp_event_type_t</tt><a class="headerlink" href="#xtcp_event_type_t" title="Permalink to this definition">¶</a></dt>
<dd><p>XTCP event type.</p>
<p>The event type represents what event is occuring on a particualr connection. It is instantiated when an event is received by the client using the <a class="reference internal" href="#xtcp_event" title="xtcp_event"><tt class="xref c c-func docutils literal"><span class="pre">xtcp_event()</span></tt></a> function.</p>
<p><strong>Enum Values:</strong></p>
<blockquote>
<div><dl class="member">
<dt id="xtcp_event_type_t.XTCP_NEW_CONNECTION">
<tt class="descname">XTCP_NEW_CONNECTION</tt><a class="headerlink" href="#xtcp_event_type_t.XTCP_NEW_CONNECTION" title="Permalink to this definition">¶</a></dt>
<dd><p>This event represents a new connection has been made.</p>
<p>In the case of a TCP server connections it occurs when a remote host firsts makes contact with the local host. For TCP client connections it occurs when a stream is setup with the remote host. For UDP connections it occurs as soon as the connection is created.</p>
</dd></dl>

<dl class="member">
<dt id="xtcp_event_type_t.XTCP_RECV_DATA">
<tt class="descname">XTCP_RECV_DATA</tt><a class="headerlink" href="#xtcp_event_type_t.XTCP_RECV_DATA" title="Permalink to this definition">¶</a></dt>
<dd><p>This event occurs when the connection has received some data.</p>
<p>The client <em>must</em> follow receipt of this event with a call to <a class="reference internal" href="#xtcp_recv" title="xtcp_recv"><tt class="xref c c-func docutils literal"><span class="pre">xtcp_recv()</span></tt></a> before any other interaction with the server.</p>
</dd></dl>

<dl class="member">
<dt id="xtcp_event_type_t.XTCP_REQUEST_DATA">
<tt class="descname">XTCP_REQUEST_DATA</tt><a class="headerlink" href="#xtcp_event_type_t.XTCP_REQUEST_DATA" title="Permalink to this definition">¶</a></dt>
<dd><p>This event occurs when the server is ready to send data and is requesting that the client send data.</p>
<p>This event happens after a call to <a class="reference internal" href="#xtcp_init_send" title="xtcp_init_send"><tt class="xref c c-func docutils literal"><span class="pre">xtcp_init_send()</span></tt></a> from the client. The client <em>must</em> follow receipt of this event with a call to <a class="reference internal" href="#xtcp_send" title="xtcp_send"><tt class="xref c c-func docutils literal"><span class="pre">xtcp_send()</span></tt></a> before any other interaction with the server.</p>
</dd></dl>

<dl class="member">
<dt id="xtcp_event_type_t.XTCP_SENT_DATA">
<tt class="descname">XTCP_SENT_DATA</tt><a class="headerlink" href="#xtcp_event_type_t.XTCP_SENT_DATA" title="Permalink to this definition">¶</a></dt>
<dd><p>This event occurs when the server has successfully sent the previous piece of data that was given to it via a call to <a class="reference internal" href="#xtcp_send" title="xtcp_send"><tt class="xref c c-func docutils literal"><span class="pre">xtcp_send()</span></tt></a>.</p>
<p>The server is now requesting more data so the client must* follow receipt of this event with a call to <a class="reference internal" href="#xtcp_send" title="xtcp_send"><tt class="xref c c-func docutils literal"><span class="pre">xtcp_send()</span></tt></a> before any other interaction with the server.</p>
</dd></dl>

<dl class="member">
<dt id="xtcp_event_type_t.XTCP_RESEND_DATA">
<tt class="descname">XTCP_RESEND_DATA</tt><a class="headerlink" href="#xtcp_event_type_t.XTCP_RESEND_DATA" title="Permalink to this definition">¶</a></dt>
<dd><p>This event occurs when the server has failed to send the previous piece of data that was given to it via a call to <a class="reference internal" href="#xtcp_send" title="xtcp_send"><tt class="xref c c-func docutils literal"><span class="pre">xtcp_send()</span></tt></a>.</p>
<p>The server is now requesting for the same data to be sent again. The client must* follow receipt of this event with a call to <a class="reference internal" href="#xtcp_send" title="xtcp_send"><tt class="xref c c-func docutils literal"><span class="pre">xtcp_send()</span></tt></a> before any other interaction with the server.</p>
</dd></dl>

<dl class="member">
<dt id="xtcp_event_type_t.XTCP_TIMED_OUT">
<tt class="descname">XTCP_TIMED_OUT</tt><a class="headerlink" href="#xtcp_event_type_t.XTCP_TIMED_OUT" title="Permalink to this definition">¶</a></dt>
<dd><p>This event occurs when the connection has timed out with the remote host (TCP only).</p>
<p>This event represents the closing of a connection and is the last event that will occur on an active connection.</p>
</dd></dl>

<dl class="member">
<dt id="xtcp_event_type_t.XTCP_ABORTED">
<tt class="descname">XTCP_ABORTED</tt><a class="headerlink" href="#xtcp_event_type_t.XTCP_ABORTED" title="Permalink to this definition">¶</a></dt>
<dd><p>This event occurs when the connection has been aborted by the local or remote host (TCP only).</p>
<p>This event represents the closing of a connection and is the last event that will occur on an active connection.</p>
</dd></dl>

<dl class="member">
<dt id="xtcp_event_type_t.XTCP_CLOSED">
<tt class="descname">XTCP_CLOSED</tt><a class="headerlink" href="#xtcp_event_type_t.XTCP_CLOSED" title="Permalink to this definition">¶</a></dt>
<dd><p>This event occurs when the connection has been closed by the local or remote host.</p>
<p>This event represents the closing of a connection and is the last event that will occur on an active connection.</p>
</dd></dl>

<dl class="member">
<dt id="xtcp_event_type_t.XTCP_POLL">
<tt class="descname">XTCP_POLL</tt><a class="headerlink" href="#xtcp_event_type_t.XTCP_POLL" title="Permalink to this definition">¶</a></dt>
<dd><p>This event occurs at regular intervals per connection.</p>
<p>Polling can be initiated and the interval can be set with <a class="reference internal" href="#xtcp_set_poll_interval" title="xtcp_set_poll_interval"><tt class="xref c c-func docutils literal"><span class="pre">xtcp_set_poll_interval()</span></tt></a></p>
</dd></dl>

<dl class="member">
<dt id="xtcp_event_type_t.XTCP_IFUP">
<tt class="descname">XTCP_IFUP</tt><a class="headerlink" href="#xtcp_event_type_t.XTCP_IFUP" title="Permalink to this definition">¶</a></dt>
<dd><p>This event occurs when the link goes up (with valid new ip address).</p>
<p>This event has no associated connection.</p>
</dd></dl>

<dl class="member">
<dt id="xtcp_event_type_t.XTCP_IFDOWN">
<tt class="descname">XTCP_IFDOWN</tt><a class="headerlink" href="#xtcp_event_type_t.XTCP_IFDOWN" title="Permalink to this definition">¶</a></dt>
<dd><p>This event occurs when the link goes down.</p>
<p>This event has no associated connection.</p>
</dd></dl>

<dl class="member">
<dt id="xtcp_event_type_t.XTCP_ALREADY_HANDLED">
<tt class="descname">XTCP_ALREADY_HANDLED</tt><a class="headerlink" href="#xtcp_event_type_t.XTCP_ALREADY_HANDLED" title="Permalink to this definition">¶</a></dt>
<dd><p>This event type does not get set by the server but can be set by the client to show an event has been handled.</p>
</dd></dl>

</div></blockquote>
</dd></dl>

<dt><dl class="type">
<dt id="xtcp_connection_type_t">
<tt class="descname">xtcp_connection_type_t</tt><a class="headerlink" href="#xtcp_connection_type_t" title="Permalink to this definition">¶</a></dt>
<dd><p>Type representing a connection type.</p>
<p><strong>Enum Values:</strong></p>
<blockquote>
<div><dl class="member">
<dt id="xtcp_connection_type_t.XTCP_CLIENT_CONNECTION">
<tt class="descname">XTCP_CLIENT_CONNECTION</tt><a class="headerlink" href="#xtcp_connection_type_t.XTCP_CLIENT_CONNECTION" title="Permalink to this definition">¶</a></dt>
<dd><p>A client connection.</p>
</dd></dl>

<dl class="member">
<dt id="xtcp_connection_type_t.XTCP_SERVER_CONNECTION">
<tt class="descname">XTCP_SERVER_CONNECTION</tt><a class="headerlink" href="#xtcp_connection_type_t.XTCP_SERVER_CONNECTION" title="Permalink to this definition">¶</a></dt>
<dd><p>A server connection.</p>
</dd></dl>

</div></blockquote>
</dd></dl>

<dt><dl class="type">
<dt id="xtcp_connection_t">
<tt class="descname">xtcp_connection_t</tt><a class="headerlink" href="#xtcp_connection_t" title="Permalink to this definition">¶</a></dt>
<dd><p>This type represents a TCP or UDP connection.</p>
<p>This is the main type containing connection information for the client to handle. Elements of this type are instantiated by the <a class="reference internal" href="#xtcp_event" title="xtcp_event"><tt class="xref c c-func docutils literal"><span class="pre">xtcp_event()</span></tt></a> function which informs the client about an event and the connection the event is on.</p>
<p><strong>Structure Members</strong>:</p>
<dl class="member">
<dt id="xtcp_connection_t.id">
int <tt class="descname">id</tt><a class="headerlink" href="#xtcp_connection_t.id" title="Permalink to this definition">¶</a></dt>
<dd><p>A unique identifier for the connection.</p>
</dd></dl>

<dl class="member">
<dt id="xtcp_connection_t.protocol">
<a class="reference internal" href="#xtcp_protocol_t" title="xtcp_protocol_t">xtcp_protocol_t</a> <tt class="descname">protocol</tt><a class="headerlink" href="#xtcp_connection_t.protocol" title="Permalink to this definition">¶</a></dt>
<dd><p>The protocol of the connection (TCP/UDP).</p>
</dd></dl>

<dl class="member">
<dt id="xtcp_connection_t.connection_type">
<a class="reference internal" href="#xtcp_connection_type_t" title="xtcp_connection_type_t">xtcp_connection_type_t</a> <tt class="descname">connection_type</tt><a class="headerlink" href="#xtcp_connection_t.connection_type" title="Permalink to this definition">¶</a></dt>
<dd><p>The type of connection (client/sever).</p>
</dd></dl>

<dl class="member">
<dt id="xtcp_connection_t.event">
<a class="reference internal" href="#xtcp_event_type_t" title="xtcp_event_type_t">xtcp_event_type_t</a> <tt class="descname">event</tt><a class="headerlink" href="#xtcp_connection_t.event" title="Permalink to this definition">¶</a></dt>
<dd><p>The last reported event on this connection.</p>
</dd></dl>

<dl class="member">
<dt id="xtcp_connection_t.appstate">
xtcp_appstate_t <tt class="descname">appstate</tt><a class="headerlink" href="#xtcp_connection_t.appstate" title="Permalink to this definition">¶</a></dt>
<dd><p>The application state associated with the connection.</p>
<p>This is set using the <a class="reference internal" href="#xtcp_set_connection_appstate" title="xtcp_set_connection_appstate"><tt class="xref c c-func docutils literal"><span class="pre">xtcp_set_connection_appstate()</span></tt></a> function.</p>
</dd></dl>

<dl class="member">
<dt id="xtcp_connection_t.remote_addr">
<a class="reference internal" href="#xtcp_ipaddr_t" title="xtcp_ipaddr_t">xtcp_ipaddr_t</a> <tt class="descname">remote_addr</tt><a class="headerlink" href="#xtcp_connection_t.remote_addr" title="Permalink to this definition">¶</a></dt>
<dd><p>The remote ip address of the connection.</p>
</dd></dl>

<dl class="member">
<dt id="xtcp_connection_t.remote_port">
unsigned int <tt class="descname">remote_port</tt><a class="headerlink" href="#xtcp_connection_t.remote_port" title="Permalink to this definition">¶</a></dt>
<dd><p>The remote port of the connection.</p>
</dd></dl>

<dl class="member">
<dt id="xtcp_connection_t.local_port">
unsigned int <tt class="descname">local_port</tt><a class="headerlink" href="#xtcp_connection_t.local_port" title="Permalink to this definition">¶</a></dt>
<dd><p>The local port of the connection.</p>
</dd></dl>

<dl class="member">
<dt id="xtcp_connection_t.mss">
unsigned int <tt class="descname">mss</tt><a class="headerlink" href="#xtcp_connection_t.mss" title="Permalink to this definition">¶</a></dt>
<dd><p>The maximum size in bytes that can be send using <a class="reference internal" href="#xtcp_send" title="xtcp_send"><tt class="xref c c-func docutils literal"><span class="pre">xtcp_send()</span></tt></a> after a send event.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="server-api">
<h2>Server API<a class="headerlink" href="#server-api" title="Permalink to this headline">¶</a></h2>
<dt><dl class="function">
<dt id="uip_server">
void <tt class="descname">uip_server</tt><big>(</big>chanend<em>&nbsp;mac_rx</em>, chanend<em>&nbsp;mac_tx</em>, chanend<em>&nbsp;xtcp[]</em>, int<em>&nbsp;num_xtcp_clients</em>, <a class="reference internal" href="#xtcp_ipconfig_t" title="xtcp_ipconfig_t">xtcp_ipconfig_t</a> &amp;<em>&nbsp;?ipconfig</em>, chanend<em>&nbsp;connect_status</em><big>)</big><a class="headerlink" href="#uip_server" title="Permalink to this definition">¶</a></dt>
<dd><p>uIP based xtcp server.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>mac_rx</strong> &#8211; Rx channel connected to ethernet server</li>
<li><strong>mac_tx</strong> &#8211; Tx channel connected to ethernet server</li>
<li><strong>xtcp</strong> &#8211; Client channel array</li>
<li><strong>num_xtcp_clients</strong> &#8211; The number of clients connected to the server</li>
<li><strong>ipconfig</strong> &#8211; An data structure representing the IP config (ip address, netmask and gateway) of the device. Leave NULL for automatic address allocation.</li>
<li><strong>connect_status</strong> &#8211; This chanend needs to be connected to the connect status output of the ethernet mac.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>This function implements an xtcp tcp/ip server in a thread. It uses a port of the uIP stack which is then interfaces over the xtcp channel array.</p>
<p>The IP setup is based on the ipconfig parameter. If this parameter is NULL then an automatic IP address is found (using dhcp or ipv4 link local addressing if no dhcp server is present). Otherwise it uses the ipconfig structure to allocate a static ip address.</p>
<p>The clients can communicate with the server using the API found in xtcp_client.h</p>
<p><strong>See also:</strong></p>
<p><a class="reference internal" href="#xtcp_event" title="xtcp_event"><tt class="xref c c-func docutils literal"><span class="pre">xtcp_event()</span></tt></a></p>
</dd></dl>

</div>
<div class="section" id="client-api">
<span id="sec-client-api"></span><h2>Client API<a class="headerlink" href="#client-api" title="Permalink to this headline">¶</a></h2>
<div class="section" id="event-receipt">
<h3>Event Receipt<a class="headerlink" href="#event-receipt" title="Permalink to this headline">¶</a></h3>
<dt><dl class="function">
<dt id="xtcp_event">
transaction <tt class="descname">xtcp_event</tt><big>(</big>chanend<em>&nbsp;c_xtcp</em>, <a class="reference internal" href="#xtcp_connection_t" title="xtcp_connection_t">xtcp_connection_t</a><em>&nbsp;&amp;conn</em><big>)</big><a class="headerlink" href="#xtcp_event" title="Permalink to this definition">¶</a></dt>
<dd><p>Receive the next connect event.</p>
<p>This can be used in a select statement.</p>
<p>Upon receiving the event, the xtcp_connection_t structure conn is instatiated with information of the event and the connection it is on.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>c_xtcp</strong> &#8211; chanend connected to the xtcp server</li>
<li><strong>conn</strong> &#8211; the connection relating to the current event</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="setting-up-connections">
<h3>Setting Up Connections<a class="headerlink" href="#setting-up-connections" title="Permalink to this headline">¶</a></h3>
<dt><dl class="function">
<dt id="xtcp_listen">
void <tt class="descname">xtcp_listen</tt><big>(</big>chanend<em>&nbsp;c_xtcp</em>, int<em>&nbsp;port_number</em>, <a class="reference internal" href="#xtcp_protocol_t" title="xtcp_protocol_t">xtcp_protocol_t</a><em>&nbsp;proto</em><big>)</big><a class="headerlink" href="#xtcp_listen" title="Permalink to this definition">¶</a></dt>
<dd><p>Listen to a particular incoming port.</p>
<p>After this call, when a connection is established a XTCP_NEW_CONNECTION event is signalled.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>c_xtcp</strong> &#8211; chanend connected to the xtcp server</li>
<li><strong>port_number</strong> &#8211; the local port number to listen to</li>
<li><strong>proto</strong> &#8211; the protocol to listen to (TCP or UDP)</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dt><dl class="function">
<dt id="xtcp_unlisten">
void <tt class="descname">xtcp_unlisten</tt><big>(</big>chanend<em>&nbsp;c_xtcp</em>, int<em>&nbsp;port_number</em><big>)</big><a class="headerlink" href="#xtcp_unlisten" title="Permalink to this definition">¶</a></dt>
<dd><p>Stop listening to a particular incoming port.</p>
<p>Applies to TCP connections only.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>c_xtcp</strong> &#8211; chanend connected to the xtcp server</li>
<li><strong>port_number</strong> &#8211; local port number to stop listening on</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dt><dl class="function">
<dt id="xtcp_connect">
void <tt class="descname">xtcp_connect</tt><big>(</big>chanend<em>&nbsp;c_xtcp</em>, int<em>&nbsp;port_number</em>, <a class="reference internal" href="#xtcp_ipaddr_t" title="xtcp_ipaddr_t">xtcp_ipaddr_t</a><em>&nbsp;ipaddr</em>, <a class="reference internal" href="#xtcp_protocol_t" title="xtcp_protocol_t">xtcp_protocol_t</a><em>&nbsp;proto</em><big>)</big><a class="headerlink" href="#xtcp_connect" title="Permalink to this definition">¶</a></dt>
<dd><p>Try to connect to a remote port.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>c_xtcp</strong> &#8211; chanend connected to the xtcp server</li>
<li><strong>port_number</strong> &#8211; the remote port to try to connect to</li>
<li><strong>ipaddr</strong> &#8211; the ip addr of the remote host</li>
<li><strong>proto</strong> &#8211; the protocol to connect with (TCP or UDP)</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dt><dl class="function">
<dt id="xtcp_bind_local">
void <tt class="descname">xtcp_bind_local</tt><big>(</big>chanend<em>&nbsp;c_xtcp</em>, <a class="reference internal" href="#xtcp_connection_t" title="xtcp_connection_t">xtcp_connection_t</a><em>&nbsp;&amp;conn</em>, int<em>&nbsp;port_number</em><big>)</big><a class="headerlink" href="#xtcp_bind_local" title="Permalink to this definition">¶</a></dt>
<dd><p>Bind the local end of a connection to a particular port (UDP).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>c_xtcp</strong> &#8211; chanend connected to the xtcp server</li>
<li><strong>conn</strong> &#8211; the connection</li>
<li><strong>port_number</strong> &#8211; the local port to set the connection to</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dt><dl class="function">
<dt id="xtcp_bind_remote">
void <tt class="descname">xtcp_bind_remote</tt><big>(</big>chanend<em>&nbsp;c_xtcp</em>, <a class="reference internal" href="#xtcp_connection_t" title="xtcp_connection_t">xtcp_connection_t</a><em>&nbsp;&amp;conn</em>, <a class="reference internal" href="#xtcp_ipaddr_t" title="xtcp_ipaddr_t">xtcp_ipaddr_t</a><em>&nbsp;addr</em>, int<em>&nbsp;port_number</em><big>)</big><a class="headerlink" href="#xtcp_bind_remote" title="Permalink to this definition">¶</a></dt>
<dd><p>Bind the remote end of a connection to a particular port and ip address.</p>
<p>This is only valid for XTCP_PROTOCOL_UDP connections. After this call, packets sent to this connection will go to the specified address and port</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>c_xtcp</strong> &#8211; chanend connected to the xtcp server</li>
<li><strong>conn</strong> &#8211; the connection</li>
<li><strong>addr</strong> &#8211; the intended remote address of the connection</li>
<li><strong>port_number</strong> &#8211; the intended remote port of the connection</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dt><dl class="function">
<dt id="xtcp_set_connection_appstate">
void <tt class="descname">xtcp_set_connection_appstate</tt><big>(</big>chanend<em>&nbsp;c_xtcp</em>, <a class="reference internal" href="#xtcp_connection_t" title="xtcp_connection_t">xtcp_connection_t</a><em>&nbsp;&amp;conn</em>, xtcp_appstate_t<em>&nbsp;appstate</em><big>)</big><a class="headerlink" href="#xtcp_set_connection_appstate" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the connections application state data item.</p>
<p>After this call, subsequent events on this connection will have the appstate field of the connection set</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>c_xtcp</strong> &#8211; chanend connected to the xtcp server</li>
<li><strong>conn</strong> &#8211; the connection</li>
<li><strong>appstate</strong> &#8211; An unsigned integer representing the state. In C this is usually a pointer to some connection dependent information.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="receiving-data">
<h3>Receiving Data<a class="headerlink" href="#receiving-data" title="Permalink to this headline">¶</a></h3>
<dt><dl class="function">
<dt id="xtcp_recv">
int <tt class="descname">xtcp_recv</tt><big>(</big>chanend<em>&nbsp;c_xtcp</em>, char<em>&nbsp;data[]</em><big>)</big><a class="headerlink" href="#xtcp_recv" title="Permalink to this definition">¶</a></dt>
<dd><p>Receive data from the server.</p>
<p>This should be called after a XTCP_RECV_DATA event.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>c_xtcp</strong> &#8211; chanend connected to the xtcp server</li>
<li><strong>data</strong> &#8211; A array to place the received data into</li>
</ul>
</td>
</tr>
<tr class="field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">The length of the received data in bytes</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dt><dl class="function">
<dt id="xtcp_recvi">
int <tt class="descname">xtcp_recvi</tt><big>(</big>chanend<em>&nbsp;c_xtcp</em>, char<em>&nbsp;data[]</em>, int<em>&nbsp;i</em><big>)</big><a class="headerlink" href="#xtcp_recvi" title="Permalink to this definition">¶</a></dt>
<dd><p>Receive data from the server.</p>
<p>This should be called after a XTCP_RECV_DATA event. The data is put into the array data starting at index i i.e. the first byte of data is written to data[i].</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>c_xtcp</strong> &#8211; chanend connected to the xtcp server</li>
<li><strong>data</strong> &#8211; A array to place the received data into</li>
<li><strong>i</strong> &#8211; The index where to start filling the data array</li>
</ul>
</td>
</tr>
<tr class="field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">The length of the received data in bytes</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="sending-data">
<h3>Sending Data<a class="headerlink" href="#sending-data" title="Permalink to this headline">¶</a></h3>
<dt><dl class="function">
<dt id="xtcp_init_send">
void <tt class="descname">xtcp_init_send</tt><big>(</big>chanend<em>&nbsp;c_xtcp</em>, <a class="reference internal" href="#xtcp_connection_t" title="xtcp_connection_t">xtcp_connection_t</a><em>&nbsp;&amp;conn</em><big>)</big><a class="headerlink" href="#xtcp_init_send" title="Permalink to this definition">¶</a></dt>
<dd><p>Initiate sending data on a connection.</p>
<p>After making this call, the server will respond with a XTCP_REQUEST_DATA event when it is ready to accept data.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>c_xtcp</strong> &#8211; chanend connected to the xtcp server</li>
<li><strong>conn</strong> &#8211; the connection</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dt><dl class="function">
<dt id="xtcp_send">
void <tt class="descname">xtcp_send</tt><big>(</big>chanend<em>&nbsp;c_xtcp</em>, char NULLABLE<em>&nbsp;data[]</em>, int<em>&nbsp;len</em><big>)</big><a class="headerlink" href="#xtcp_send" title="Permalink to this definition">¶</a></dt>
<dd><p>Send data to the server.</p>
<p>This should be called after a XTCP_REQUEST_DATA, XTCP_SENT_DATA or XTCP_RESEND_DATA event (alternatively xtcp_write_buf can be called). To finish sending this must be called with a length of zero or call the <a class="reference internal" href="#xtcp_complete_send" title="xtcp_complete_send"><tt class="xref c c-func docutils literal"><span class="pre">xtcp_complete_send()</span></tt></a> function.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>c_xtcp</strong> &#8211; chanend connected to the xtcp server</li>
<li><strong>data</strong> &#8211; An array of data to send</li>
<li><strong>len</strong> &#8211; The length of data to send. If this is 0, no data will be sent and a XTCP_SENT_DATA event will not occur.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dt><dl class="function">
<dt id="xtcp_sendi">
void <tt class="descname">xtcp_sendi</tt><big>(</big>chanend<em>&nbsp;c_xtcp</em>, char NULLABLE<em>&nbsp;data[]</em>, int<em>&nbsp;i</em>, int<em>&nbsp;len</em><big>)</big><a class="headerlink" href="#xtcp_sendi" title="Permalink to this definition">¶</a></dt>
<dd><p>Send data to the server.</p>
<p>This should be called after a XTCP_REQUEST_DATA, XTCP_SENT_DATA or XTCP_RESEND_DATA event (alternatively xtcp_write_buf can be called). The data is sent starting from index i i.e. data[i] is the first byte to be sent. To finish sending this must be called with a length of zero.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>c_xtcp</strong> &#8211; chanend connected to the xtcp serve</li>
<li><strong>data</strong> &#8211; An array of data to send</li>
<li><strong>i</strong> &#8211; The index at which to start reading from the data array</li>
<li><strong>len</strong> &#8211; The length of data to send. If this is 0, no data will be sent and a XTCP_SENT_DATA event will not occur.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dt><dl class="function">
<dt id="xtcp_complete_send">
void <tt class="descname">xtcp_complete_send</tt><big>(</big>chanend<em>&nbsp;c_xtcp</em><big>)</big><a class="headerlink" href="#xtcp_complete_send" title="Permalink to this definition">¶</a></dt>
<dd><p>Complete a send transaction with the server.</p>
<p>This function can be called after a XTCP_REQUEST_DATA, XTCP_SENT_DATA or XTCP_RESEND_DATA event to finish any sending on the connection that the event related to.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>c_xtcp</strong> &#8211; chanend connected to the tcp server</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="other-connection-management">
<h3>Other Connection Management<a class="headerlink" href="#other-connection-management" title="Permalink to this headline">¶</a></h3>
<dt><dl class="function">
<dt id="xtcp_set_poll_interval">
void <tt class="descname">xtcp_set_poll_interval</tt><big>(</big>chanend<em>&nbsp;c_xtcp</em>, <a class="reference internal" href="#xtcp_connection_t" title="xtcp_connection_t">xtcp_connection_t</a><em>&nbsp;&amp;conn</em>, int<em>&nbsp;poll_interval</em><big>)</big><a class="headerlink" href="#xtcp_set_poll_interval" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the poll interval for a udp connection in seconds.</p>
<p>If this is called then the udp connection will cause a poll event every poll_interval milliseconds.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>c_xtcp</strong> &#8211; chanend connected to the xtcp server</li>
<li><strong>conn</strong> &#8211; the connection</li>
<li><strong>poll_interval</strong> &#8211; the required poll interval in milliseconds</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dt><dl class="function">
<dt id="xtcp_close">
void <tt class="descname">xtcp_close</tt><big>(</big>chanend<em>&nbsp;c_xtcp</em>, <a class="reference internal" href="#xtcp_connection_t" title="xtcp_connection_t">xtcp_connection_t</a><em>&nbsp;&amp;conn</em><big>)</big><a class="headerlink" href="#xtcp_close" title="Permalink to this definition">¶</a></dt>
<dd><p>Close a connection.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>c_xtcp</strong> &#8211; chanend connected to the xtcp server</li>
<li><strong>conn</strong> &#8211; the connection</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dt><dl class="function">
<dt id="xtcp_abort">
void <tt class="descname">xtcp_abort</tt><big>(</big>chanend<em>&nbsp;c_xtcp</em>, <a class="reference internal" href="#xtcp_connection_t" title="xtcp_connection_t">xtcp_connection_t</a><em>&nbsp;&amp;conn</em><big>)</big><a class="headerlink" href="#xtcp_abort" title="Permalink to this definition">¶</a></dt>
<dd><p>Abort a connection.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>c_xtcp</strong> &#8211; chanend connected to the xtcp server</li>
<li><strong>conn</strong> &#8211; the connection</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="other-general-client-functions">
<h3>Other General Client Functions<a class="headerlink" href="#other-general-client-functions" title="Permalink to this headline">¶</a></h3>
<dt><dl class="function">
<dt id="xtcp_join_multicast_group">
void <tt class="descname">xtcp_join_multicast_group</tt><big>(</big>chanend<em>&nbsp;c_xtcp</em>, <a class="reference internal" href="#xtcp_ipaddr_t" title="xtcp_ipaddr_t">xtcp_ipaddr_t</a><em>&nbsp;addr</em><big>)</big><a class="headerlink" href="#xtcp_join_multicast_group" title="Permalink to this definition">¶</a></dt>
<dd><p>Subscribe to a particular ip multicast group address.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>c_xtcp</strong> &#8211; chanend connected to the xtcp server</li>
<li><strong>addr</strong> &#8211; The address of the multicast group to join. It is assumed that this is a multicast IP address.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dt><dl class="function">
<dt id="xtcp_leave_multicast_group">
void <tt class="descname">xtcp_leave_multicast_group</tt><big>(</big>chanend<em>&nbsp;c_xtcp</em>, <a class="reference internal" href="#xtcp_ipaddr_t" title="xtcp_ipaddr_t">xtcp_ipaddr_t</a><em>&nbsp;addr</em><big>)</big><a class="headerlink" href="#xtcp_leave_multicast_group" title="Permalink to this definition">¶</a></dt>
<dd><p>Unsubscribe to a particular ip multicast group address.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>c_xtcp</strong> &#8211; chanend connected to the xtcp server</li>
<li><strong>addr</strong> &#8211; The address of the multicast group to leave. It is assumed that this is a multicast IP address which has previously been joined.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dt><dl class="function">
<dt id="xtcp_get_mac_address">
void <tt class="descname">xtcp_get_mac_address</tt><big>(</big>chanend<em>&nbsp;c_xtcp</em>, unsigned char<em>&nbsp;mac_addr[]</em><big>)</big><a class="headerlink" href="#xtcp_get_mac_address" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the current host MAC address of the server.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>c_xtcp</strong> &#8211; chanend connected to the xtcp server</li>
<li><strong>mac_addr</strong> &#8211; the array to be filled with the mac address</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dt><dl class="function">
<dt id="xtcp_get_ipconfig">
void <tt class="descname">xtcp_get_ipconfig</tt><big>(</big>chanend<em>&nbsp;c_xtcp</em>, <a class="reference internal" href="#xtcp_ipconfig_t" title="xtcp_ipconfig_t">xtcp_ipconfig_t</a><em>&nbsp;&amp;ipconfig</em><big>)</big><a class="headerlink" href="#xtcp_get_ipconfig" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the current host IP configuration of the server.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>c_xtcp</strong> &#8211; chanend connected to the xtcp server</li>
<li><strong>ipconfig</strong> &#8211; the structure to be filled with the IP configuration information</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
</div>
</div>



          </div>
        </div>
      </div>
      <div class="sphinxsidebar" id='d2'>
        <div class="sphinxsidebarwrapper">
<h3><a href="index.html">XTCP TCP/IP Stack (2v0)</a></h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="hw.html">H/W Development Platforms</a></li>
<li class="toctree-l1"><a class="reference internal" href="system.html">TCP/IP Stack System Description</a></li>
<li class="toctree-l1"><a class="reference internal" href="programming.html">Programming Guide</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="">API</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#configuration-defines">Configuration Defines</a></li>
<li class="toctree-l2"><a class="reference internal" href="#data-structures-types">Data Structures/Types</a></li>
<li class="toctree-l2"><a class="reference internal" href="#server-api">Server API</a></li>
<li class="toctree-l2"><a class="reference internal" href="#client-api">Client API</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#event-receipt">Event Receipt</a></li>
<li class="toctree-l3"><a class="reference internal" href="#setting-up-connections">Setting Up Connections</a></li>
<li class="toctree-l3"><a class="reference internal" href="#receiving-data">Receiving Data</a></li>
<li class="toctree-l3"><a class="reference internal" href="#sending-data">Sending Data</a></li>
<li class="toctree-l3"><a class="reference internal" href="#other-connection-management">Other Connection Management</a></li>
<li class="toctree-l3"><a class="reference internal" href="#other-general-client-functions">Other General Client Functions</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="references.html">References</a></li>
</ul>

<div id="searchbox" style="display: none">
  <h3>Search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" size="18" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>



    <div class="footer">
    </div>
  </body>
</html>



